---
title: "Bike lanes in Buenos Aires City"
description: "Created for Day 26 (Transport) of the [#30daymapchallenge](https://30daymapchallenge.com/), bike lane connectivity in Buenos Aires City."
date: "2025-11-26"
lang: en
categories: [30 day map challenge, Interactive map, Urban planning]
image: ../images/P11_cover.png
format:
  html:
    code-fold: true 
---
****
## Project Overview

:::{.text-justify}
lorem ipsum
:::

## Data Sources and Tools

* Bike lanes and EcoBici stations: [IDECABA](https://idecaba.buenosaires.gob.ar/)
* Basemap: [Argenmap by National Geography Institute of Argentina](https://www.ign.gob.ar/AreaServicios/Argenmap/Introduccion)

****
* Made with ![](../images/QGIS.png){width=1em style="vertical-align: middle;"}[GIS](https://qgis.org/project/overview/) 3.22.4-Białowieża

## Interactive map
```{r}
#| echo: true
#| code-summary: "Click to view code"
#| warning: false
#| message: false

library(sf)
library(leaflet)
library(dplyr)

sf_use_s2(FALSE)
folder_path <- "../vectors"

load_layer <- function(filename) {
  full_path <- file.path(folder_path, filename)
  if (file.exists(full_path)) {
    return(st_read(full_path, quiet = TRUE) %>% st_zm())
  }
  return(NULL)
}

merged_lines <- load_layer("merged_single.geojson")
ecobici      <- load_layer("ecobici.geojson")
puntos_ruteo <- load_layer("ptruteo.geojson")

if (!is.null(ecobici)) ecobici <- st_cast(ecobici, "POINT")
if (!is.null(puntos_ruteo)) puntos_ruteo <- st_cast(puntos_ruteo, "POINT")

my_colors <- c(
  "Bike lane"            = "#1b9e77",
  "One-way bike lane"    = "#7570b3",
  "Suggested bike lanes" = "red",
  "Suggested routing"    = "#d95f02", 
  "Current routing"      = "black"
)

if (!is.null(merged_lines)) {
  lines_split <- split(merged_lines, merged_lines$gna)
} else {
  lines_split <- list()
}

if (!is.null(puntos_ruteo)) {
  parque_points <- filter(puntos_ruteo, nam == "Parque de la Memoria")
  other_stops   <- filter(puntos_ruteo, nam != "Parque de la Memoria")
} else {
  parque_points <- NULL; other_stops <- NULL
}

desired_order <- c(
  "Starting routing point",  
  "Routing end points",
  "Current routing",         # Dashed
  "Suggested routing",       # Dashed
  "EcoBici Stations",
  "Bike lane",
  "One-way bike lane",
  "Suggested bike lanes"     
)

map <- leaflet() %>%
  setView(lng = -58.44, lat = -34.61, zoom = 12) %>%
  addTiles(
    urlTemplate = "[https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/](https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/){z}/{x}/{-y}.png",
    attribution = "Argenmap - IGN Argentina",
    options = tileOptions(tms = TRUE), group = "Argenmap"
  ) %>%
  addProviderTiles(providers$CartoDB.DarkMatter, group = "Carto Dark Matter")

for (group_name in rev(desired_order)) {
  
  if (group_name %in% names(lines_split)) {
    
    layer_data <- lines_split[[group_name]]
    
    col <- ifelse(group_name %in% names(my_colors), my_colors[group_name], "#555555")
    
    my_dash <- if(group_name %in% c("Current routing", "Suggested routing")) "5, 7" else NULL
    
    map <- map %>%
      addPolylines(
        data = layer_data,
        color = col,
        weight = 2, opacity = 1,
        dashArray = my_dash,  
        group = group_name, 
        popup = ~gna
      )
  

  } else if (group_name == "Starting routing point" && !is.null(parque_points)) {
    map <- map %>% addCircleMarkers(
      data = parque_points, radius = 6, fillColor = "darkorange", fillOpacity = 1,
      stroke = TRUE, color = "tomato", weight = 2,
      group = group_name
    )
    
  } else if (group_name == "Routing end points" && !is.null(other_stops)) {
    map <- map %>% addCircleMarkers(
      data = other_stops, radius = 4, fillColor = "#faff39", fillOpacity = 0.8,
      stroke = TRUE, color = "#e6bc26", weight = 1.5,
      group = group_name
    )
    
  } else if (group_name == "EcoBici Stations" && !is.null(ecobici)) {
    map <- map %>% addCircleMarkers(
      data = ecobici, radius = 2, fillColor = "#fd7da3", fillOpacity = 0.8,
      stroke = TRUE, color = "#cb6598", weight = 0.3,
      group = group_name
    )
  }
}

existing_lines <- names(lines_split)
existing_points <- c("Starting routing point", "Routing end points", "EcoBici Stations")
all_found <- c(existing_lines, existing_points)

final_groups <- intersect(desired_order, all_found)

map %>%
  addLayersControl(
    baseGroups = c("Argenmap", "Carto Dark Matter"),
    overlayGroups = final_groups, 
    options = layersControlOptions(collapsed = FALSE)
  )
```

## The final map for Day 26

::: {.text-center}
![](../images/P11_map1.png){width=100% class="lightbox"}

![](../images/P11_map2.png){width=100% class="lightbox"}
:::

